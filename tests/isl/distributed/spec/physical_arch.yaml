arch:
  name: "test_distributed_spec"
  nodes:
  - !Container
    name: system_arch
    # TODO: attributes are placeholders.
    attributes:
      # Top-level attributes inherited by all components unless overridden
      technology: "45nm"
      cycle_period: 1e-9

  - !Network
    name: L1
    topology: Mesh
    spatial:
      - x
      - y
    constraints:
      - -1 <= x < 2
      - 0 <= y <= 16
 
  - !Component
    name: DRAM                 # offchip DRAM is the source of all datatypes
    class: DRAM                # assume DRAM is large enough to store all the data, so no depth specification needed
    attributes:
      width: 64                # width in bits
    network:
      level: L1
      placement: "{ DRAM[i] -> L1[x, y] : i = 0 and x = 0 and y = 0 }"

  # registers for the mac unit
  - !Memory
    name: Scratchpad
    class: SRAM
    attributes:
      datawidth: 16
      width: 16
      size: 40
      dims: [i, j]
    spatial:
      meshI: 2
      meshJ: 16
    network:
      level: L1
      placement: |
        meshJ = y and x < 0 and meshI = -x - 1;
        meshJ = y and x > 0 and meshI = x;

  - !Component
    name: mac
    class: mac_compute
    attributes: {num_pipline_stages: 2}