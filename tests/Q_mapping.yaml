  # d=4, all others = 2
  # - name: Q
  #   tensor_accesses:
  #   - {name: I, projection: [ b, m, d ]}
  #   - {name: WQ, projection: [ h, e, d ]}
  #   - {name: Q, projection: [ b, m, h, e ], output: True}

mapping:
  version: "0.5"
  nodes:
  - !Storage
    tensors: [I, WQ, Q]
    component: MainMemory
  - !Temporal
    rank_variable: b
    tile_shape: 1
  - !Temporal
    rank_variable: h
    tile_shape: 1
  - !Temporal
    rank_variable: e
    tile_shape: 1
  - !Spatial
    rank_variable: d
    tile_shape: 1
    name: 0
    component: LocalBuffer
  - !Storage
    tensors: [Q]
    component: LocalBuffer
  - !Temporal
    rank_variable: m
    tile_shape: 1
  - !Storage
    tensors: [I]
    component: LocalBuffer
  - !Compute
    einsum: Q
    compute: MAC