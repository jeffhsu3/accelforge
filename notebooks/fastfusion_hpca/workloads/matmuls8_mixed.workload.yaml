renames:
  version: "0.5"
  einsums:
  - name: default
    tensor_accesses:
    - name: input
      source: Inputs() & Intermediates()
      expected_count: 1
    - name: output
      source: Outputs()
      expected_count: 1
    - name: weight
      source: ~(input | output)
      expected_count: 1
    rank_variables:
    - name: parallel_rank
      source: output.rank_variables() & weight.rank_variables()
      expected_count: 1
    - name: reduced_rank
      source: input.rank_variables() & weight.rank_variables() - output.rank_variables()
      expected_count: 1


  - name: Matmul1
    tensor_accesses:
    - name: input
      source: T0

workload:
  version: "0.5"
  shape:
    m:  0 <= m  < 12800
    n0: 0 <= n0 < 6400
    n1: 0 <= n1 < 6400
    n2: 0 <= n2 < 12800
    n3: 0 <= n3 < 12800
    n4: 0 <= n4 < 6400
    n5: 0 <= n5 < 6400
    n6: 0 <= n6 < 12800
    n7: 0 <= n7 < 12800
    n8: 0 <= n8 < 6400

  einsums:
  - name: Matmul1
    tensor_accesses:
    - {name: T0, projection: [m, n0]}
    - {name: W1, projection: [n0, n1]}
    - {name: T1, projection: [m, n1], output: True}

  - name: Matmul2
    tensor_accesses:
    - {name: T1, projection: [m, n1]}
    - {name: W2, projection: [n1, n2]}
    - {name: T2, projection: [m, n2], output: True}

  - name: Matmul3
    tensor_accesses:
    - {name: T2, projection: [m, n2]}
    - {name: W3, projection: [n2, n3]}
    - {name: T3, projection: [m, n3], output: True}

  - name: Matmul4
    tensor_accesses:
    - {name: T3, projection: [m, n3]}
    - {name: W4, projection: [n3, n4]}
    - {name: T4, projection: [m, n4], output: True}

  - name: Matmul5
    tensor_accesses:
    - {name: T4, projection: [m, n4]}
    - {name: W5, projection: [n4, n5]}
    - {name: T5, projection: [m, n5], output: True}

  - name: Matmul6
    tensor_accesses:
    - {name: T5, projection: [m, n5]}
    - {name: W6, projection: [n5, n6]}
    - {name: T6, projection: [m, n6], output: True}

  - name: Matmul7
    tensor_accesses:
    - {name: T6, projection: [m, n6]}
    - {name: W7, projection: [n6, n7]}
    - {name: T7, projection: [m, n7], output: True}

  - name: Matmul8
    tensor_accesses:
    - {name: T7, projection: [m, n7]}
    - {name: W8, projection: [n7, n8]}
    - {name: T8, projection: [m, n8], output: True}
