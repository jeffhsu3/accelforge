workload:
  version: "0.5"
  shape:
    pa0: 0 <= pa0 < {P}
    qa0: 0 <= qa0 < {P}
    pb0: 0 <= pb0 < {P}
    qb0: 0 <= qb0 < {P}
    n0: 0 <= n0 < {N0}
    t0: 0 <= t0 < {N0}
    n1: 0 <= n1 < {N1}

  einsums:
  - name: PwiseA0
    tensor_accesses:
    - {name: T0, projection: [pa0, qa0, n0]}
    - {name: WA0, projection: [n0, t0]}
    - {name: TA0, projection: [pa0, qa0, t0], output: True}

  - name: Dwise0
    tensor_accesses:
    - name: TA0
      projection:
        PA0: pb0 + r0
        QA0: qb0 + s0
        T0: t0
    - {name: WAB0, projection: [r0, s0, t0]}
    - {name: TB0, projection: [pb0, qb0, t0], output: True}
    shape:
    - 0 <= r0 < 3
    - 0 <= s0 < 3

  - name: PwiseB0
    tensor_accesses:
    - {name: TB0, projection: [pB0, qB0, t0]}
    - {name: WB0, projection: [t0, n1]}
    - {name: T1, projection: [pB0, qB0, n1], output: True}
